javascript:(function(){ var bill = getText("div[aria-label^='Bill,']>div>div>button"); var take = getText("div[aria-label^='Take']>div>span"); var star = getText("div[aria-label^='Star']>div>span"); var amdStart = getText("div[aria-label^='AMD start']>div>span"); var amdEnd = getText("div[aria-label^='AMD end']>div>span"); var ncStart = getText("div[aria-label^='NC start']>div>span"); var ncEnd = getText("div[aria-label^='NC end']>div>span"); var nsStart = getText("div[aria-label^='NS start']>div>span"); var nsEnd = getText("div[aria-label^='NS end']>div>span"); function getText(query){ var element = document.querySelector(query); var elementText; try{ elementText = element.textContent; } catch(e) { return ''; } return elementText; } var amdTotal; if (Number(amdStart) == 0) { amdTotal = 0; } else if (Number(amdEnd) == 0) { amdTotal = 1; } else { amdTotal = Number(amdEnd) - Number(amdStart) + 1; } var ncTotal; if (Number(ncStart) == 0) { ncTotal = 0; } else if (Number(ncEnd) == 0) { ncTotal = 1; } else { ncTotal = Number(ncEnd) - Number(ncStart) + 1; } var nsTotal; if (Number(nsStart) == 0) { nsTotal = 0; } else if(Number(nsEnd) == 0) { nsTotal = 1; } else { nsTotal = Number(nsEnd) - Number(nsStart) + 1; } var files; console.log(document.querySelector("div[aria-label^='Files']>div>span")); if (document.querySelector("div[aria-label^='Files']>div>span").textContent == 'Yes'){ files = ''; var attachments =  document.querySelectorAll("div.ReactFieldEditor-Attachments-Renderer>a"); console.log(attachments); for (var i = 0; i < attachments.length; i++) { files += ' <br/> ' + attachments[i].textContent; } } else { files = 'N/A'; } var totalamds = Number(amdTotal) + Number(ncTotal) + Number(nsTotal); var html = "<html lang='en'><head><meta charset='UTF-8'><title>Amendment Take Sheet</title><style>html{font-family:'Frutiger LT Std',Verdana,Helvetica,Arial,sans-serif;font-size:x-large;}.container{width:90%;margin:auto;}h2{text-align:center;font-size:xx-large;padding-bottom:30%;}.left{float:left;}.right{float:right;}.right > strong{font-size:xx-large}.clear{clear:both;}.bill{padding-bottom:30%;}.amds{padding-bottom:20%;}</style></head><body><div class='container'><div class='firstrow'><p class='left'>Paper: <strong></strong></p><p class='right'>Take: <strong>" + take + "</strong></p><div class='clear'></div></div><h2>Amendment Take Sheet</h2><p>&nbsp;</p><p class='bill'>Title of Bill: <strong>" + bill + "</strong></p><p class='amds'>Number of Amendments: <strong>" + totalamds + "</strong></p><p>See file(s): <strong>" + files + "</strong></p><p>Star? <strong>" + star + "</strong></p></div></body></html>"; var myWindow = (window.open("", "", "width=900, height=1050")); var writeOutput = myWindow.document.write(html); myWindow.print(); myWindow.document.close(); })();